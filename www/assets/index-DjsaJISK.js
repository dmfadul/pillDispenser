(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();var M;(function(n){n[n.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",n[n.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",n[n.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(M||(M={}));var F;(function(n){n[n.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",n[n.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",n[n.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"})(F||(F={}));/*! Capacitor: https://capacitorjs.com/ - MIT License */var S;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(S||(S={}));class k extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const re=n=>{var e,t;return n!=null&&n.androidBridge?"android":!((t=(e=n==null?void 0:n.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},ae=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},s=t.Plugins=t.Plugins||{},r=()=>e!==null?e.name:re(n),a=()=>r()!=="web",i=u=>{const l=f.get(u);return!!(l!=null&&l.platforms.has(r())||o(u))},o=u=>{var l;return(l=t.PluginHeaders)===null||l===void 0?void 0:l.find(O=>O.name===u)},d=u=>n.console.error(u),f=new Map,y=(u,l={})=>{const O=f.get(u);if(O)return console.warn(`Capacitor plugin "${u}" already registered. Cannot register plugins twice.`),O.proxy;const b=r(),C=o(u);let p;const te=async()=>(!p&&b in l?p=typeof l[b]=="function"?p=await l[b]():p=l[b]:e!==null&&!p&&"web"in l&&(p=typeof l.web=="function"?p=await l.web():p=l.web),p),ne=(h,m)=>{var v,E;if(C){const L=C==null?void 0:C.methods.find(g=>m===g.name);if(L)return L.rtype==="promise"?g=>t.nativePromise(u,m.toString(),g):(g,D)=>t.nativeCallback(u,m.toString(),g,D);if(h)return(v=h[m])===null||v===void 0?void 0:v.bind(h)}else{if(h)return(E=h[m])===null||E===void 0?void 0:E.bind(h);throw new k(`"${u}" plugin is not implemented on ${b}`,S.Unimplemented)}},R=h=>{let m;const v=(...E)=>{const L=te().then(g=>{const D=ne(g,h);if(D){const q=D(...E);return m=q==null?void 0:q.remove,q}else throw new k(`"${u}.${h}()" is not implemented on ${b}`,S.Unimplemented)});return h==="addListener"&&(L.remove=async()=>m()),L};return v.toString=()=>`${h.toString()}() { [capacitor code] }`,Object.defineProperty(v,"name",{value:h,writable:!1,configurable:!1}),v},H=R("addListener"),V=R("removeListener"),se=(h,m)=>{const v=H({eventName:h},m),E=async()=>{const g=await v;V({eventName:h,callbackId:g},m)},L=new Promise(g=>v.then(()=>g({remove:E})));return L.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await E()},L},$=new Proxy({},{get(h,m){switch(m){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return C?se:H;case"removeListener":return V;default:return R(m)}}});return s[u]=$,f.set(u,{name:u,proxy:$,platforms:new Set([...Object.keys(l),...C?[b]:[]])}),$};return t.convertFileSrc||(t.convertFileSrc=u=>u),t.getPlatform=r,t.handleError=d,t.isNativePlatform=a,t.isPluginAvailable=i,t.registerPlugin=y,t.Exception=k,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ie=n=>n.Capacitor=ae(n),P=ie(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),N=P.registerPlugin;class z{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),s&&this.sendRetainedArgumentsForEvent(e);const i=async()=>this.removeListener(e,t);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,s){const r=this.listeners[e];if(!r){if(s){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}return}r.forEach(a=>a(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:s=>{this.notifyListeners(t,s)}}}unimplemented(e="not implemented"){return new P.Exception(e,S.Unimplemented)}unavailable(e="not available"){return new P.Exception(e,S.Unavailable)}async removeListener(e,t){const s=this.listeners[e];if(!s)return;const r=s.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(s=>{this.notifyListeners(e,s)}))}}const Y=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),K=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class oe extends z{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[r,a]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=K(r).trim(),a=K(a).trim(),t[r]=a}),t}async setCookie(e){try{const t=Y(e.key),s=Y(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),i=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${r}; path=${a}; ${i};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}N("CapacitorCookies",{web:()=>new oe});const ce=async n=>new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{const r=s.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},s.onerror=r=>t(r),s.readAsDataURL(n)}),le=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(r=>r.toLocaleLowerCase()).reduce((r,a,i)=>(r[a]=n[e[i]],r),{})},ue=(n,e=!0)=>n?Object.entries(n).reduce((s,r)=>{const[a,i]=r;let o,d;return Array.isArray(i)?(d="",i.forEach(f=>{o=e?encodeURIComponent(f):f,d+=`${a}=${o}&`}),d.slice(0,-1)):(o=e?encodeURIComponent(i):i,d=`${a}=${o}`),`${s}&${d}`},"").substr(1):null,de=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),r=le(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(r.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[i,o]of Object.entries(n.data||{}))a.set(i,o);t.body=a.toString()}else if(r.includes("multipart/form-data")||n.data instanceof FormData){const a=new FormData;if(n.data instanceof FormData)n.data.forEach((o,d)=>{a.append(d,o)});else for(const o of Object.keys(n.data))a.append(o,n.data[o]);t.body=a;const i=new Headers(t.headers);i.delete("content-type"),t.headers=i}else(r.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class fe extends z{async request(e){const t=de(e,e.webFetchExtra),s=ue(e.params,e.shouldEncodeUrlParams),r=s?`${e.url}?${s}`:e.url,a=await fetch(r,t),i=a.headers.get("content-type")||"";let{responseType:o="text"}=a.ok?e:{};i.includes("application/json")&&(o="json");let d,f;switch(o){case"arraybuffer":case"blob":f=await a.blob(),d=await ce(f);break;case"json":d=await a.json();break;case"document":case"text":default:d=await a.text()}const y={};return a.headers.forEach((u,l)=>{y[l]=u}),{data:d,headers:y,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}N("CapacitorHttp",{web:()=>new fe});function we(n){return new DataView(Uint8Array.from(n).buffer)}function he(n){return Array.from(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}function me(n){return`0000${n.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function ye(n){const e=[];let t,s,r=1,a=0;for(t=0;t<n.length;t++)s=n.charCodeAt(t),(s>47&&s<58||s>64&&s<71||s>96&&s<103)&&(a=a<<4^(s>64?s+9:s)&15,(r^=1)&&e.push(a&255));return we(e)}function U(n){return he(n).map(e=>{let t=e.toString(16);return t.length==1&&(t="0"+t),t}).join("")}function De(n){if(typeof n=="string")return n;if(typeof n=="number")return me(n);throw new Error("Invalid UUID")}function qe(n){const e={};if(n)return n.forEach((t,s)=>{e[s.toString()]=t}),e}const ge="modulepreload",ve=function(n){return"/"+n},G={},be=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let i=function(f){return Promise.all(f.map(y=>Promise.resolve(y).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=i(t.map(f=>{if(f=ve(f),f in G)return;G[f]=!0;const y=f.endsWith(".css"),u=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${u}`))return;const l=document.createElement("link");if(l.rel=y?"stylesheet":ge,y||(l.as="script"),l.crossOrigin="",l.href=f,d&&l.setAttribute("nonce",d),document.head.appendChild(l),y)return new Promise((O,b)=>{l.addEventListener("load",O),l.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return r.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},c=N("BluetoothLe",{web:()=>be(()=>import("./web-CGK7O5ot.js"),[]).then(n=>new n.BluetoothLeWeb)}),pe=()=>{let n=Promise.resolve();return e=>new Promise((t,s)=>{n=n.then(()=>e()).then(t).catch(s)})};function j(n){return n?pe():e=>e()}function w(n){if(typeof n!="string")throw new Error(`Invalid UUID type ${typeof n}. Expected string.`);if(n=n.toLowerCase(),!(n.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${n}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return n}class Ee{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=j(!0)}enableQueue(){this.queue=j(!0)}disableQueue(){this.queue=j(!1)}async initialize(e){await this.queue(async()=>{await c.initialize(e)})}async isEnabled(){return await this.queue(async()=>(await c.isEnabled()).value)}async requestEnable(){await this.queue(async()=>{await c.requestEnable()})}async enable(){await this.queue(async()=>{await c.enable()})}async disable(){await this.queue(async()=>{await c.disable()})}async startEnabledNotifications(e){await this.queue(async()=>{var t;const s="onEnabledChanged";await((t=this.eventListeners.get(s))===null||t===void 0?void 0:t.remove());const r=await c.addListener(s,a=>{e(a.value)});this.eventListeners.set(s,r),await c.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var e;const t="onEnabledChanged";await((e=this.eventListeners.get(t))===null||e===void 0?void 0:e.remove()),this.eventListeners.delete(t),await c.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await c.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await c.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await c.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await c.openAppSettings()})}async setDisplayStrings(e){await this.queue(async()=>{await c.setDisplayStrings(e)})}async requestDevice(e){return e=e?this.validateRequestBleDeviceOptions(e):void 0,await this.queue(async()=>await c.requestDevice(e))}async requestLEScan(e,t){e=this.validateRequestBleDeviceOptions(e),await this.queue(async()=>{var s;await((s=this.scanListener)===null||s===void 0?void 0:s.remove()),this.scanListener=await c.addListener("onScanResult",r=>{const a=Object.assign(Object.assign({},r),{manufacturerData:this.convertObject(r.manufacturerData),serviceData:this.convertObject(r.serviceData),rawAdvertisement:r.rawAdvertisement?this.convertValue(r.rawAdvertisement):void 0});t(a)}),await c.requestLEScan(e)})}async stopLEScan(){await this.queue(async()=>{var e;await((e=this.scanListener)===null||e===void 0?void 0:e.remove()),this.scanListener=null,await c.stopLEScan()})}async getDevices(e){if(!Array.isArray(e))throw new Error("deviceIds must be an array");return this.queue(async()=>(await c.getDevices({deviceIds:e})).devices)}async getConnectedDevices(e){if(!Array.isArray(e))throw new Error("services must be an array");return e=e.map(w),this.queue(async()=>(await c.getConnectedDevices({services:e})).devices)}async getBondedDevices(){return this.queue(async()=>(await c.getBondedDevices()).devices)}async connect(e,t,s){await this.queue(async()=>{var r;if(t){const a=`disconnected|${e}`;await((r=this.eventListeners.get(a))===null||r===void 0?void 0:r.remove());const i=await c.addListener(a,()=>{t(e)});this.eventListeners.set(a,i)}await c.connect(Object.assign({deviceId:e},s))})}async createBond(e,t){await this.queue(async()=>{await c.createBond(Object.assign({deviceId:e},t))})}async isBonded(e){return await this.queue(async()=>(await c.isBonded({deviceId:e})).value)}async disconnect(e){await this.queue(async()=>{await c.disconnect({deviceId:e})})}async getServices(e){return await this.queue(async()=>(await c.getServices({deviceId:e})).services)}async discoverServices(e){await this.queue(async()=>{await c.discoverServices({deviceId:e})})}async getMtu(e){return await this.queue(async()=>(await c.getMtu({deviceId:e})).value)}async requestConnectionPriority(e,t){await this.queue(async()=>{await c.requestConnectionPriority({deviceId:e,connectionPriority:t})})}async readRssi(e){return await this.queue(async()=>{const s=await c.readRssi({deviceId:e});return parseFloat(s.value)})}async read(e,t,s,r){return t=w(t),s=w(s),await this.queue(async()=>{const i=await c.read(Object.assign({deviceId:e,service:t,characteristic:s},r));return this.convertValue(i.value)})}async write(e,t,s,r,a){return t=w(t),s=w(s),this.queue(async()=>{if(!(r!=null&&r.buffer))throw new Error("Invalid data.");let i=r;P.getPlatform()!=="web"&&(i=U(r)),await c.write(Object.assign({deviceId:e,service:t,characteristic:s,value:i},a))})}async writeWithoutResponse(e,t,s,r,a){t=w(t),s=w(s),await this.queue(async()=>{if(!(r!=null&&r.buffer))throw new Error("Invalid data.");let i=r;P.getPlatform()!=="web"&&(i=U(r)),await c.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:s,value:i},a))})}async readDescriptor(e,t,s,r,a){return t=w(t),s=w(s),r=w(r),await this.queue(async()=>{const o=await c.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:s,descriptor:r},a));return this.convertValue(o.value)})}async writeDescriptor(e,t,s,r,a,i){return t=w(t),s=w(s),r=w(r),this.queue(async()=>{if(!(a!=null&&a.buffer))throw new Error("Invalid data.");let o=a;P.getPlatform()!=="web"&&(o=U(a)),await c.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:s,descriptor:r,value:o},i))})}async startNotifications(e,t,s,r){t=w(t),s=w(s),await this.queue(async()=>{var a;const i=`notification|${e}|${t}|${s}`;await((a=this.eventListeners.get(i))===null||a===void 0?void 0:a.remove());const o=await c.addListener(i,d=>{r(this.convertValue(d==null?void 0:d.value))});this.eventListeners.set(i,o),await c.startNotifications({deviceId:e,service:t,characteristic:s})})}async stopNotifications(e,t,s){t=w(t),s=w(s),await this.queue(async()=>{var r;const a=`notification|${e}|${t}|${s}`;await((r=this.eventListeners.get(a))===null||r===void 0?void 0:r.remove()),this.eventListeners.delete(a),await c.stopNotifications({deviceId:e,service:t,characteristic:s})})}validateRequestBleDeviceOptions(e){return e.services&&(e.services=e.services.map(w)),e.optionalServices&&(e.optionalServices=e.optionalServices.map(w)),e}convertValue(e){return typeof e=="string"?ye(e):e===void 0?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(e===void 0)return;const t={};for(const s of Object.keys(e))t[s]=this.convertValue(e[s]);return t}}const _=new Ee,Le=document.getElementById("alarm-form"),Q=document.getElementById("alarm-hour-select"),X=document.getElementById("alarm-minute-select"),J=document.getElementById("alarm-list"),Oe=document.getElementById("clear-alarms"),B=document.getElementById("dispense-hour-select"),T=document.getElementById("dispense-minute-select"),A="alarmTimes",x="dispenseTime";function I(n){return n.toString().padStart(2,"0")}function Z(n,e){for(let t=0;t<24;t++){const s=document.createElement("option");s.value=I(t),s.textContent=I(t),n.appendChild(s)}for(let t=0;t<60;t+=5){const s=document.createElement("option");s.value=I(t),s.textContent=I(t),e.appendChild(s)}}function W(){const n=JSON.parse(localStorage.getItem(A))||[];J.innerHTML="",n.forEach((e,t)=>{const s=document.createElement("li");s.innerHTML=`
      ${e}
      <button onclick="deleteAlarm(${t})">Remove</button>
    `,J.appendChild(s)})}Le.addEventListener("submit",n=>{n.preventDefault();const e=Q.value,t=X.value,s=`${e}:${t}`;let r=JSON.parse(localStorage.getItem(A))||[];r.includes(s)||(r.push(s),localStorage.setItem(A,JSON.stringify(r)),W())});Oe.addEventListener("click",()=>{localStorage.removeItem(A),W()});function Ce(){const n=localStorage.getItem(x);if(n){const[e,t]=n.split(":");B.value=e,T.value=t}}function ee(){const n=B.value,e=T.value,t=`${n}:${e}`;localStorage.setItem(x,t)}document.addEventListener("deviceready",Pe,!1);function Pe(){console.log("Device is ready"),document.getElementById("connect-btn").addEventListener("click",Se),document.getElementById("send-config-btn").addEventListener("click",Ae)}async function Se(){_.initialize(),console.log("Checking if Bluetooth is enabled...");try{if(!await _.isEnabled()){alert("Please enable Bluetooth.");return}console.log("Bluetooth is enabled."),await _.connect("98:DA:60:0D:8B:28"),window.connectedDeviceId="98:DA:60:0D:8B:28"}catch(n){console.error("Bluetooth error:",n),alert("Failed to connect: "+(n.message||"Unknown error"))}}async function Ae(){if(!window.connectedDeviceId){alert("Please connect to the device first.");return}const n=JSON.parse(localStorage.getItem(A))||[],e=localStorage.getItem(x)||null,s=JSON.stringify({alarms:n,dispense:e})+`
`,r=new TextEncoder().encode(s);try{await _.write(window.connectedDeviceId,NORDIC_UART_SERVICE,NORDIC_UART_TX_CHARACTERISTIC,r),alert("Config sent!")}catch(a){console.error("Bluetooth write error:",a),alert("Failed to send config.")}}B.addEventListener("change",ee);T.addEventListener("change",ee);Z(Q,X);Z(B,T);W();Ce();export{z as W,ye as h,qe as m,De as w};
