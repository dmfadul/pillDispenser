(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const y=document.getElementById("alarm-form"),f=document.getElementById("alarm-hour-select"),g=document.getElementById("alarm-minute-select"),p=document.getElementById("alarm-list"),v=document.getElementById("clear-alarms"),c=document.getElementById("dispense-hour-select"),a=document.getElementById("dispense-minute-select"),i="alarmTimes",u="dispenseTime";function l(e){return e.toString().padStart(2,"0")}function h(e,r){for(let t=0;t<24;t++){const n=document.createElement("option");n.value=l(t),n.textContent=l(t),e.appendChild(n)}for(let t=0;t<60;t+=5){const n=document.createElement("option");n.value=l(t),n.textContent=l(t),r.appendChild(n)}}function m(){const e=JSON.parse(localStorage.getItem(i))||[];p.innerHTML="",e.forEach((r,t)=>{const n=document.createElement("li");n.innerHTML=`
      ${r}
      <button onclick="deleteAlarm(${t})">Remove</button>
    `,p.appendChild(n)})}y.addEventListener("submit",e=>{e.preventDefault();const r=f.value,t=g.value,n=`${r}:${t}`;let o=JSON.parse(localStorage.getItem(i))||[];o.includes(n)||(o.push(n),localStorage.setItem(i,JSON.stringify(o)),m())});v.addEventListener("click",()=>{localStorage.removeItem(i),m()});function I(){const e=localStorage.getItem(u);if(e){const[r,t]=e.split(":");c.value=r,a.value=t}}function E(){const e=c.value,r=a.value,t=`${e}:${r}`;localStorage.setItem(u,t)}let S=!1;const L="98:DA:60:0D:8B:28";document.addEventListener("deviceready",B,!1);function O(){var t,n;const e=(n=(t=window.cordova)==null?void 0:t.plugins)==null?void 0:n.permissions;if(!e){alert("Permissions plugin not available.");return}const r=[e.BLUETOOTH,e.BLUETOOTH_ADMIN,e.BLUETOOTH_CONNECT,e.BLUETOOTH_SCAN,e.ACCESS_FINE_LOCATION];e.hasPermission(r,o=>{o.hasPermission?console.log("Permissions already granted."):e.requestPermissions(r,s=>{s.hasPermission?console.log("All Bluetooth permissions granted."):alert("Bluetooth permissions denied. The app may not work properly.")},s=>{console.error("Request error:",s),alert("Error requesting Bluetooth permissions.")})},o=>{console.error("Check error:",o),alert("Error checking Bluetooth permissions.")})}function B(){console.log("Device is ready"),bluetoothSerial.list(e=>{e.forEach((r,t)=>{console.log(`Device ${t+1}:`),console.log(`  Name: ${r.name}`),console.log(`  MAC: ${r.id}`)})},e=>{console.error("List error:",e)}),O(),document.getElementById("connect-btn").addEventListener("click",A),document.getElementById("send-config-btn").addEventListener("click",C),bluetoothSerial.subscribe(`
`,e=>{console.log("Received from Arduino:",e)})}function A(){bluetoothSerial.connect(L,()=>{S=!0,alert("Connected to HC-06!")},()=>{alert("FAILURE to connectify. Make sure itâ€™s really paired in Android settings.")})}function C(){if(!S){alert("Not connected to device!");return}const e=JSON.parse(localStorage.getItem(i))||[],r=localStorage.getItem(u)||null,n=JSON.stringify({alarms:e,dispense:r}).trim()+`
`;bluetoothSerial.write(n,()=>{console.log("Sent to Arduino:",n),alert("Horarios enviado para o device!")},o=>{console.error("Bluetooth write error:",o)})}c.addEventListener("change",E);a.addEventListener("change",E);h(f,g);h(c,a);m();I();
